function sequenceCounts(a,b){var c=[],d=[];a.forEach(function(a){c.push(a[1]),a[3]&&d.push(a[3])});var e=c.reduce(function(a,b){return b in a?a[b]++:a[b]=1,a},{}),f=d.reduce(function(a,b){return b in a?a[b]++:a[b]=1,a},{}),g="",h="";for(var i in e)g+="<p>"+i+" : "+e[i]+", total mass: "+b[i]*e[i]+"</p>";for(var i in f)h+="<p>"+i+" : "+f[i]+"</p>";return $("#basesCount").html(g),$("#linksCount").html(h),[e,f]}function sequenceReformat(a){var b=[],c=[];a.forEach(function(a){"d"===a[2].toLowerCase()?b.push(a[1]):c.push(a[1])});var d="["+b.join("")+"]"+c.join("");return $("#sequenceReformatting").html(d),d}function sequenceValidation(a){var b=["-","m","b","d"],c=["A","G","C","T","U","R","Y","S","W","K","M","B","D","H","V","N"],d=["d","r","e","m","y","l","k","o"],e=["o","s"],f=a.join("").split(""),g=[],h=0;f.forEach(function(a,b){g[b]=0}),a.forEach(function(a,f){b.indexOf(a[0])<0&&(g[4*f+0]="modifier not correct",h++),c.indexOf(a[1])<0&&(g[4*f+1]="base not correct",h++),d.indexOf(a[2])<0&&(g[4*f+2]="sugar not correct",h++),e.indexOf(a[3])<0&&a[3]&&(g[4*f+3]="linkage not correct",h++)});var i="";return f.forEach(function(a,b){i+=0===g[b]?a:"<code>"+a+"</code>"}),$("#sequenceValidation").html('<p class="sequenceOutput">'+i+"</p>"),h>0?(1===h?$("#sequenceValidation").append("<p>There is 1 error</p>"):$("#sequenceValidation").append("<p>There are "+h+" errors</p>"),g.forEach(function(a,b){0!==a&&$("#sequenceValidation").append("<p>position: "+(b+1)+" there is a "+a)})):($(".sequenceOutput").addClass("text-success"),$("#sequenceValidation").append("<p>Sequence correct!</p>")),h}$(function(){$("#sequenceForm").on("submit",function(a){a.preventDefault();var b=$("#sequence").val().match(/.{1,4}/g),c={A:5,C:5,G:5,T:5,U:5,W:5,S:5,M:5,K:5,R:5,Y:5,B:5,D:5,H:5,V:5,N:5};sequenceCounts(b,c),sequenceReformat(b),sequenceValidation(b)}),$("#testData").on("click",function(){$("#sequence").val("-Gdo-Gdo-Ado-Ado-Udo-Gro-Gro-Cro-Uro-Uro-Uro-Ur")}),$("#testWrongData").on("click",function(){$("#sequence").val("-Gdo-Gdo-Ado-Ado-Udo-Gro-Wro-Cro-Uro-Uro-Uro=Ur")})});